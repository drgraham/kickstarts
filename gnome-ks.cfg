graphical
lang en_US.UTF-8
keyboard --vckeymap=us --xlayouts=us
network --bootproto=dhcp --ipv6=auto --onboot=on --activate
timezone --utc America/Denver

ignoredisk --only-use=sda
zerombr
clearpart --all --initlabel --disklabel=gpt
autopart --type=lvm
bootloader --location=mbr --boot-drive=sda --append="rhgb quiet"

url --mirrorlist=https://mirrors.fedoraproject.org/mirrorlist?repo=fedora-$releasever&arch=$arch

auth --enableshadow --passalgo=sha512
rootpw --plaintext --lock a
user --name=dgraham --gecos=dgraham --groups=wheel --password=a --plaintext --shell=/usr/bin/fish --uid=1337 --gid=1337

firstboot --disable
firewall --enabled --ssh
selinux --enforcing
xconfig --defaultdesktop=GNOME --startxonboot
reboot

%packages

@^workstation-product-environment
@development-tools
@fonts
@libreoffice
@rpm-development-tools
acpi
aisleriot
android-tools
aspell-en
aspell-fr
bibletime
bind-utils
blender
bluefish
calligra-krita
copr-cli
curl
dconf-editor
deltarpm
diffutils
dnf-plugins-core
python3-dnf-plugins-extras-tracer
ed
enchant
eog
evince
fbreader
-firefox
fish
florence
freerdp
frozen-bubble
galculator
gcc-c++
ghex
gimp
gimp-data-extras
gimp-help
gimp-help-browser
gimp-resynthesizer
GitPython
gnome-mahjongg
gnome-mines
gnome-robots
gnome-sudoku
gnome-tetravex
gnuplot
gpick
graphviz
hdparm
hexchat
hfsplus-tools
hunspell-en
hunspell-fr
hydrogen
iagno
ImageMagick
inkscape
iotop
keepassx
knetwalk
konqueror
kshisen
ktorrent
lcdtest
linux-libertine-fonts
linux-libertine-biolinum-fonts
livestreamer
memtest86+
mlocate
mousepad
ncdu
nfs-utils
nmap
ntfs-3g
ntfsprogs
optipng
p7zip
p7zip-plugins
pandoc
pavucontrol
pyp2rpm
python-beautifulsoup4
python-dnf-plugins-extras-tracer
python-PyGithub
python-sh
pytz
python-urllib3
PyYAML
renameutils
retext
rpmlint
rsync
ruby-devel
ruby-irb
ruby-RMagick
rubygem-json
rubygem-psych
rubygem-rake
rubygem-sass
screenfetch
scribus
smartmontools
sox
sqlite
strace
swell-foop
synfigstudio
tcpdump
tcptraceroute
tftp
ttmkfdir
udftools
unar
vim-enhanced
vim-X11
w3m
w3m-img
wget
wireshark
wireshark-gnome
xar
xfce4-terminal
xpdf
xsane-gimp

%end

%post

dnf -y copr enable drgraham/apngasm
dnf -y copr enable drgraham/apngutils
dnf -y copr enable drgraham/praw
dnf -y copr enable cygn/pulseaudio-dlna

printf "[google-chrome]\n" > /etc/yum.repos.d/google-chrome.repo
printf "name=google-chrome\n" >> /etc/yum.repos.d/google-chrome.repo
printf "baseurl=https://dl.google.com/linux/chrome/rpm/stable/x86_64\n" >> /etc/yum.repos.d/google-chrome.repo
printf "enabled=1\n" >> /etc/yum.repos.d/google-chrome.repo
printf "gpgcheck=1\n" >> /etc/yum.repos.d/google-chrome.repo
printf "gpgkey=https://dl.google.com/linux/linux_signing_key.pub\n" >> /etc/yum.repos.d/google-chrome.repo

dnf -y install http://download1.rpmfusion.org/free/fedora/rpmfusion-free-release-$(rpm -E %fedora).noarch.rpm
dnf -y install http://download1.rpmfusion.org/nonfree/fedora/rpmfusion-nonfree-release-$(rpm -E %fedora).noarch.rpm
dnf -y clean all
dnf -y makecache
dnf -y upgrade
dnf -y install apng2gif apngasm apngdis apngopt ffmpeg gif2apng google-chrome-stable gstreamer-plugins-ugly gstreamer1-plugins-ugly kdenlive lame mpv pulseaudio-dlna rtmpdump vlc

systemctl enable sshd
systemctl enable systemd-timesyncd
systemctl enable fstrim.timer

mkdir -p /etc/udev/hwdb.d
printf "evdev:input:*\n" > /etc/udev/hwdb.d/70-keyboard-custom.hwdb
printf " KEYBOARD_KEY_70039=leftctrl\n" >> /etc/udev/hwdb.d/70-keyboard-custom.hwdb
printf " KEYBOARD_KEY_700e0=capslock\n" >> /etc/udev/hwdb.d/70-keyboard-custom.hwdb
printf "\n" >> /etc/udev/hwdb.d/70-keyboard-custom.hwdb
printf "evdev:atkbd:dmi:*\n" >> /etc/udev/hwdb.d/70-keyboard-custom.hwdb
printf " KEYBOARD_KEY_3a=leftctrl\n" >> /etc/udev/hwdb.d/70-keyboard-custom.hwdb
printf " KEYBOARD_KEY_1d=capslock\n" >> /etc/udev/hwdb.d/70-keyboard-custom.hwdb
udevadm hwdb --update

%end
